import{u as F,r as p,j as e,F as v,d as S,a as q}from"./index-DH2IhMRx.js";const V=()=>{const{t:s}=F(),[l,P]=p.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",role:"customer"}),[t,c]=p.useState(null),[j,y]=p.useState(""),[w,f]=p.useState(!1),[i,C]=p.useState({password:!1,confirmPassword:!1}),N=a=>{C(o=>({...o,[a]:!o[a]}))},d=a=>{P({...l,[a.target.name]:a.target.value}),t&&c(null)},k=()=>{const{name:a,email:o,phone:x,password:u,confirmPassword:h,role:g}=l,n={};return a.length<3&&(n.name=s("signup.errors.nameTooShort")),/^\S+@\S+\.\S+$/.test(o)||(n.email=s("signup.errors.invalidEmail")),/^\d{9,15}$/.test(x)||(n.phone=s("signup.errors.invalidPhone")),u.length<6?n.password=s("signup.errors.passwordTooShort"):u!==h&&(n.confirmPassword=s("signup.errors.passwordMismatch")),["customer","landowner"].includes(g)||(n.role=s("signup.errors.invalidRole")),Object.keys(n).length?n:null},$=async a=>{var x,u,h,g,n;a.preventDefault(),f(!0),c(null),y("");const o=k();if(o){c(o),f(!1);return}try{const{confirmPassword:m,...b}=l;b.phone=b.phone.toString(),console.log("Submitting data:",JSON.stringify(b,null,2));const E=await q.post("/api/auth/signup",b,{headers:{"Content-Type":"application/json"}});console.log("Signup successful:",E.data),y(s("signup.success"))}catch(m){console.error("Signup error:",((x=m.response)==null?void 0:x.data)||m.message),(h=(u=m.response)==null?void 0:u.data)!=null&&h.errors?c(m.response.data.errors):c({general:((n=(g=m.response)==null?void 0:g.data)==null?void 0:n.message)||s("signup.errors.general")})}finally{f(!1)}},r=a=>{var o;return(t==null?void 0:t[a])||((o=t==null?void 0:t.errors)==null?void 0:o[a])};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:e.jsxs("form",{onSubmit:$,className:"w-full max-w-md bg-white p-6 rounded-xl shadow-md space-y-4",noValidate:!0,children:[e.jsx("h2",{className:"text-2xl font-bold text-center",children:s("signup.title")}),(t==null?void 0:t.general)&&e.jsx("p",{className:"text-red-500 text-sm",children:t.general}),j&&e.jsx("p",{className:"text-green-600 text-sm",children:j}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:s("signup.name")}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:`w-full border rounded px-3 py-2 ${r("name")?"border-red-500":""}`,required:!0,minLength:"3"}),r("name")&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r("name")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:s("signup.email")}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:d,className:`w-full border rounded px-3 py-2 ${r("email")?"border-red-500":""}`,required:!0}),r("email")&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r("email")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:s("signup.phone")}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:d,className:`w-full border rounded px-3 py-2 ${r("phone")?"border-red-500":""}`,required:!0,pattern:"[0-9]{9,15}"}),r("phone")&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r("phone")})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-1",children:s("signup.password")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:i.password?"text":"password",value:l.password,onChange:d,className:`w-full px-3 py-2 border rounded-md ${r("password")?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0,minLength:6}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 px-3 flex items-center",onClick:()=>N("password"),"aria-label":i.password?"Hide password":"Show password",children:i.password?e.jsx(v,{className:"text-gray-500 hover:text-gray-700"}):e.jsx(S,{className:"text-gray-500 hover:text-gray-700"})})]}),r("password")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r("password")})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium mb-1",children:s("signup.confirmPassword")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:i.confirmPassword?"text":"password",value:l.confirmPassword,onChange:d,className:`w-full px-3 py-2 border rounded-md ${r("confirmPassword")?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 px-3 flex items-center",onClick:()=>N("confirmPassword"),"aria-label":i.confirmPassword?"Hide password":"Show password",children:i.confirmPassword?e.jsx(v,{className:"text-gray-500 hover:text-gray-700"}):e.jsx(S,{className:"text-gray-500 hover:text-gray-700"})})]}),r("confirmPassword")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r("confirmPassword")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:s("signup.role")}),e.jsxs("select",{name:"role",value:l.role,onChange:d,className:`w-full border rounded px-3 py-2 ${r("role")?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"customer",children:s("signup.customer")}),e.jsx("option",{value:"landowner",children:s("signup.landowner")})]}),r("role")&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r("role")})]}),e.jsx("button",{type:"submit",className:`w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition ${w?"opacity-70 cursor-not-allowed":""}`,disabled:w,children:s(w?"signup.submitting":"signup.button")})]})})};export{V as default};
